<div class="container">
  <div class="wrapper">
    <h2 class="title">New Patient</h2>
    <mat-stepper [orientation]="deviceOrientation" [linear]="true" #stepper>
      <mat-step>
        <ng-template matStepLabel>Consent</ng-template>
        <h2 class="title">Consent</h2>

        <div class="consent-leter">
          <div class="content">
            <p>Dear Patient:</p>

            <p>
              Thank you for choosing our practice for your optometry needs. This
              document contains important information about the optometry test
              you will be undergoing. We want you to fully understand the
              process. Please carefully read all information presented and
              contact us if you have any questions.
            </p>
            <p>
              The purpose of the optometry test is to assess the current
              functioning and health of your eyes. The eye test may include, but
              is not limited to, an assessment of your visual acuity, color
              vision, depth perception, refraction, and physical health. The
              test may also check for signs of common eye disorders, such as
              glaucoma, cataracts, and macular degeneration.
            </p>
            <p>
              At the start of the test, you will be asked to complete a
              questionnaire that provides us with general information about your
              family medical history, medications, and lifestyle. After the
              questionnaire is complete, a visual acuity test will be
              administered. This may involve using an eye chart or hand-held
              magnifying lens to evaluate your sight at various distances. Next,
              the eye doctor may check for depth perception, color vision, and
              eye alignment. If additional testing is required, the doctor may
              perform refraction and/or retinoscopy to measure the amount of
              near- and farsightedness.
            </p>

            <p>
              In addition, the optometrist may also examine the overall health
              of the eye, including corneal curvature, pupil dilation, and the
              presence of any eye disease. Your eye pressure may be tested to
              check for glaucoma. Finally, the doctor may evaluate your eyes
              using ophthalmoscopy to check eye structures, such as the retina,
              optic disk and macula.
            </p>

            <p>
              If you have any questions or concerns about the optometry test or
              any aspect of our practice, please contact us. We look forward to
              helping you meet all of your optometry needs. Sincerely, Optometry
              Practice
            </p>
          </div>
        </div>
        <p>
          By signing below I acknowledge that I have received the Toku Inc.
          BioAge Consent Form. I have been given the right to review such
          consent form prior to signing this acknowledgement. I understand this
          organization has the right to change this Consent Form from time to
          time and that I may have to contact the organization to obtain a
          current copy. I consent to my details being passed to Toku Inc. so
          that the BioAge assessment can be run, and that I can receive a copy
          of my results. No information will be passed to any other third
          parties.
        </p>
        <form action="" [formGroup]="thirdFormGroup">
          <div class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              id="optOut"
              formControlName="optOut"
            />
            <label for="optOut">
              Opt out of anonymised details being used for research purposes
              (optional)
            </label>
          </div>
        </form>
        <div class="signature-area">
          <label for="canvas">Signature</label>
          <canvas #canvas id="canvas" [width]="canvasWidth" height="110"></canvas>

          <div class="footer">
            <div class="sign-date">Signed on: {{ today | date }}</div>
            <div (click)="clearSign()" class="text-danger clear">Clear</div>
          </div>
        </div>

        <div class="actions">
          <button
            routerLink="patients"
            class="btn btn-outline-primary btn-regular-outlined"
          >
            Cancel
          </button>
          <div>
            <button
              class="btn btn-outline-primary btn-regular-outlined"
              matStepperPrevious
            >
              Back
            </button>
            <button class="btn btn-primary btn-regular" (click)="submit()">
              Agree
            </button>
          </div>
        </div>
      </mat-step>
      <mat-step [stepControl]="firstFormGroup">
        <ng-template matStepLabel>Patient ID</ng-template>
        <h2 class="title">Patient ID</h2>
        <form action="" [formGroup]="firstFormGroup">
          <div class="row">
            <div class="form-group">
              <label for="patientId" i18n
                >Patient ID <span class="required">*</span></label
              >
              <input
                type="text"
                class="form-control"
                id="patientId"
                formControlName="patientId"
                placeholder="Enter a patient id"
                i18n-placeholder
              />
              <div *ngIf="ffg.patientId.invalid" class="error">
                Patient Id is required.
              </div>
            </div>
          </div>
        </form>
        <div class="actions">
          <button
            routerLink="/patients"
            class="btn btn-outline-primary btn-regular-outlined"
          >
            Cancel
          </button>
          <button class="btn btn-primary btn-regular" matStepperNext>
            Continue to Patient
          </button>
        </div>
      </mat-step>
      <mat-step [stepControl]="secondFormGroup" label="Fill out your address">
        <ng-template matStepLabel>Patient Details</ng-template>
        <h2 class="title">Patient Details</h2>
        <form action="" [formGroup]="secondFormGroup">
          <div class="row">
            <div class="col-lg-6">
              <div class="form-group">
                <label for="ethnicity" i18n
                  >Ethnicity <span class="required">*</span>
                </label>
                <select
                  id="ethnicity"
                  class="form-select"
                  formControlName="ethnicity"
                >
                  <option value="" disabled>Select</option>
                  <option value="white">White</option>
                  <option value="black/africanamerican">
                    Black / African American
                  </option>
                  <option value="asian">Asian</option>
                  <option value="hispanic">Hispanic</option>
                  <option value="nativehawaiianorpacificislander">
                    Native Hawaiian or Pacific Islander
                  </option>
                  <option value="americanindianoralaskannative">
                    American Indian or Alaskan Native
                  </option>
                </select>
                <div *ngIf="sfg.ethnicity.invalid" class="error">
                  Ethnicity is required.
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="form-group">
                <label for="gender" i18n
                  >Gender <span class="required">*</span></label
                >
                <select
                  id="gender"
                  class="form-select"
                  formControlName="gender"
                >
                  <option value="" disabled>Select</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                </select>
                <div *ngIf="sfg.gender.invalid" class="error">
                  Gender is required.
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="form-group">
              <label for="email" i18n
                >Email <span class="required">*</span></label
              >
              <input
                type="email"
                class="form-control"
                id="email"
                formControlName="email"
                placeholder="Enter email"
                i18n-placeholder
              />
              <div *ngIf="sfg.email.invalid" class="error">
                Email is required.
              </div>
            </div>
          </div>
          <p style="margin-top: 20px">
            Please, review the options below and select if any applies to you:
            <span class="required">*</span>
          </p>
          <div class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              id="isPragnent"
              formControlName="isPragnent"
            />
            <label for="isPragnent"> I am currently pregnant </label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              id="isExperienceHeartAttack"
              formControlName="isExperienceHeartAttack"
            />
            <label for="isExperienceHeartAttack">
              I have experienced a cardiac event, such as a stroke or heart
              attack, etc.
            </label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              id="isHasEyeIssue"
              formControlName="isHasEyeIssue"
            />
            <label for="isHasEyeIssue">
              I do have a persistent visual impairment, congenital eye disease
              or history of significant ocular trauma in one or both eyes
            </label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="checkbox"
              id="isNone"
              formControlName="isNone"
            />
            <label for="isNone"> None of the above </label>
          </div>

          <div
            *ngIf="secondFormGroup.errors?.['checkboxSelectionError']"
            class="error"
          >
            At least one checkbox need to be selected.
          </div>
        </form>

        <div class="actions">
          <button
            routerLink="/patients"
            class="btn btn-outline-primary btn-regular-outlined"
          >
            Cancel
          </button>
          <div>
            <button
              class="btn btn-outline-primary btn-regular-outlined"
              matStepperPrevious
            >
              Back
            </button>
            <button
              class="btn btn-primary btn-regular"
              (click)="goForward(stepper)"
            >
              Continue to Consent
            </button>
          </div>
        </div>
      </mat-step>
    </mat-stepper>
  </div>
</div>
